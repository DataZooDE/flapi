# Project name and description
project_name: example-flapi-project
project_description: An example flAPI project demonstrating various configuration options

# Template configuration
template:
  # The path where SQL templates and API endpoint configurations are stored
  path: './sqls'
  # Optional: List of regular expressions for whitelisting environment variables
  environment-whitelist:
    - '^FLAPI_.*'

# Database connection configurations
connections:
  # A BigQuery connection named 'bigquery-lakehouse'
  bigquery-lakehouse: 
    # SQL commands to initialize the connection (e.g., loading extensions)
    init: |
      INSTALL 'bigquery' FROM community;
      LOAD 'bigquery';
    # Connection-specific properties (accessible in templates via {{ context.conn.property_name }})
    properties:
      project_id: 'd-kaercher-lakehouse'

  # A local Parquet file connection
  customers-parquet:
    properties:
      path: './data/customers.parquet'

  northwind-sqlite:
    init: |
      INSTALL sqlite;
      LOAD sqlite;

      ATTACH IF NOT EXISTS './examples/data/northwind.sqlite' AS nw (TYPE sqlite);

  sap-abap-trial:
    init: |
      INSTALL 'erpl' FROM 'http://get.erpl.io';
      LOAD 'erpl';

      CREATE OR REPLACE PERSISTENT SECRET abap_trial (
        TYPE sap_rfc, 
        ASHOST 'localhost', 
        SYSNR '00', 
        CLIENT '001', 
        USER 'DEVELOPER', 
        PASSWD 'ABAPtr2023#00',
        LANG 'EN'
      );
    

      
# Heartbeat configuration
heartbeat:
  enabled: true # Whether to enable the heartbeat worker, off by default
  worker-interval: 10

# HTTPS enforcement configuration
enforce-https:
  # Whether to force HTTPS for all connections
  enabled: false
  # ssl-cert-file: './ssl/cert.pem'
  # ssl-key-file: './ssl/key.pem'

# DuckDB configuration
duckdb:
  # db_path: ./flapi_cache.db  # Optional: remove or comment out for in-memory database
  access_mode: READ_WRITE
  threads: 8
  max_memory: 8GB
  default_order: DESC

# DuckLake configuration (for advanced caching with snapshots and time-travel)
ducklake:
  enabled: true
  alias: cache  # Catalog alias for DuckLake tables
  metadata_path: ./data/cache.ducklake  # Path to DuckLake metadata
  data_path: ./data/cache  # Path to DuckLake data files
  retention:
    keep_last_snapshots: 10  # Keep last 10 snapshots for each table
    max_snapshot_age: 30d    # Delete snapshots older than 30 days
  compaction:
    enabled: true
    schedule: '@daily'  # Run compaction daily
  scheduler:
    enabled: true
    scan_interval: 5m  # Check for scheduled cache refreshes every 5 minutes

# ====================================================================================
# MCP (Model Context Protocol) Support
# ====================================================================================
# flAPI now automatically enables MCP server - no separate configuration needed!
# Any configuration file in the sqls/ directory can define:
# - REST endpoints (if 'url-path' is present)
# - MCP tools (if 'mcp-tool' section is present)
# - MCP resources (if 'mcp-resource' section is present)
# - Or any combination of the above!
#
# Example unified configuration in sqls/customers-unified.yaml:
# url-path: /customers/                    # Makes this a REST endpoint
# mcp-tool:                                # Also makes this an MCP tool
#   name: get_customers
#   description: Retrieve customer information by ID
# request:
#   - field-name: id
#     # ... rest of parameter definitions
# template-source: customers.sql
# connection: [customers-parquet]
# # ... other common sections work for both REST and MCP

